/*
	Nepali Calendar jQuery plugin by Mahesh Maharjan 2015
	http://www.mahesh247.com.np
*/
(function(e){var k,f="";e_diff=1944;k=function(){var a=null;e.ajax({async:!1,global:!1,url:"json/dates.json",dataType:"json",success:function(b){a=b}});return a}();var m=[31,28,31,30,31,30,31,31,30,31,30,31],n=[31,29,31,30,31,30,31,31,30,31,30,31];e.Calendar=function(a,b){this.$el=e(b);this._init(a);e_eq_date="1-1-1944";n_eq_date="17-9-2000"};e.Calendar.defaults={weeks:"\u0906\u0907\u0924\u092c\u093e\u0930 ;\u0938\u094b\u092e\u092c\u093e\u0930;\u092e\u0919\u094d\u0917\u0932\u092c\u093e\u0930;\u092c\u0941\u0927\u092c\u093e\u0930;\u092c\u093f\u0939\u0940\u092c\u093e\u0930;\u0936\u0941\u0915\u094d\u0930\u092c\u093e\u0930;\u0936\u0928\u093f\u092c\u093e\u0930".split(";"), weekabbrs:"\u0906\u0907\u0924\u092c\u093e\u0930 ;\u0938\u094b\u092e\u092c\u093e\u0930;\u092e\u0919\u094d\u0917\u0932\u092c\u093e\u0930;\u092c\u0941\u0927\u092c\u093e\u0930;\u092c\u093f\u0939\u0940\u092c\u093e\u0930;\u0936\u0941\u0915\u094d\u0930\u092c\u093e\u0930;\u0936\u0928\u093f\u092c\u093e\u0930".split(";"),months:" \u092c\u0948\u0936\u093e\u0916 \u091c\u0947\u0937\u094d\u0920 \u0905\u0938\u093e\u0930 \u0936\u094d\u0930\u0935\u0923 \u092d\u093e\u0926\u094d\u0930 \u0905\u0938\u094b\u091c \u0915\u093e\u0930\u094d\u0924\u093f\u0915 \u092e\u0919\u094d\u0938\u093f\u0930 \u092a\u094c\u0937 \u092e\u093e\u0918 \u092b\u093e\u0917\u0941\u0928 \u091a\u0948\u0924\u094d\u0930".split(" "), displayWeekAbbr:!1,displayMonthAbbr:!1,startIn:0,nNum:"\u0966\u0967\u0968\u0969\u096a\u096b\u096c\u096d\u096e\u096f".split(""),onDayClick:function(a,b,d){return!1}};e.Calendar.prototype={_init:function(a){this.options=e.extend(!0,{},e.Calendar.defaults,a);this.today=new Date;e_month=this.today.getMonth()+1;e_year=this.today.getFullYear();e_date=this.today.getDate();count_days=this._count_ad_days(e_year,e_month,e_date);today_nep=this._get_nepali_date(count_days);nep_date=this._get_nepali_date(count_days); this.month=isNaN(this.options.month)||null==this.options.month?nep_date[1]:this.options.month-1;this.year=isNaN(this.options.year)||null==this.options.year?nep_date[0]:this.options.year;this.caldata=this.options.caldata||{};this._generateTemplate();this._initEvents()},_isLeap:function(a){return 0==a%4?!0:!1},_initEvents:function(){var a=this;this.$el.on("click.calendar","div.fc-row > div",function(){var b=e(this),d=b.index(),c=b.children("div"),d={day:b.children("span.fc-date").text(),month:a.month+ 1,monthname:a.options.displayMonthAbbr?a.options.monthabbrs[a.month]:a.options.months[a.month],year:a.year,weekday:d+a.options.startIn,weekdayname:a.options.weeks[d+a.options.startIn]};if(d.day)a.options.onDayClick(b,c,d)})},_generateTemplate:function(a){var b=this._getHead(),d=this._getBody(),c;switch(this.rowTotal){case 4:c="fc-four-rows";break;case 5:c="fc-five-rows";break;case 6:c="fc-six-rows"}this.$cal=e('<div class="fc-calendar '+c+'">').append(b,d);this.$el.find("div.fc-calendar").remove().end().append(this.$cal); a&&a.call()},_getHead:function(){for(var a='<div class="fc-head">',b=0;6>=b;b++)var d=b+this.options.startIn,c=6<d?d-6-1:d,a=6==d?a+'<div class="holiday">':a+"<div>",a=a+(this.options.displayWeekAbbr?this.options.weekabbrs[c]:this.options.weeks[c]),a=a+"</div>";return a+"</div>"},_getBody:function(){yr=k[this.year];monthLength=yr[this.month];this.startingDay=""===f?nep_date[4]:f;for(var a='<div class="fc-body"><div class="fc-row">',b=1,d=0;7>d;d++){for(var c=0;6>=c;c++){var e=this.startingDay-this.options.startIn, l=0>e?6+e+1:e,e="",g=this.month===today_nep[1]&&this.year===today_nep[0]&&b===today_nep[2],h="";b<=monthLength&&(0<d||c>=l)?(e+='<span class="fc-date">'+this._engToNepDigit(b)+'</span><span class="fc-weekday">'+this.options.weekabbrs[6<c+this.options.startIn?c+this.options.startIn-6-1:c+this.options.startIn]+"</span>",(l=this.caldata[(10>this.month?"0"+this.month:this.month)+"-"+(10>b?"0"+b:b)])&&(h=l),""!==h&&(e+="<div>"+h+"</div>"),++b):g=!1;g=g?"fc-today ":"";""!==h&&(g+="fc-content");a=6==c?a+ (""!==g?'<div class="'+g+'">':'<div class="holiday">'):a+(""!==g?'<div class="'+g+'">':"<div>");a+=e;a+="</div>"}if(b>monthLength){this.rowTotal=d+1;break}else a+='</div><div class="fc-row">'}return a+"</div></div>"},_getNepaliDate:function(){},_count_ad_days:function(a,b,d){var c=0;for(i=0;i<a-e_diff;i++)if(!0===this._isLeap(e_diff+i))for(j=0;12>j;j++)c+=n[j];else for(j=0;12>j;j++)c+=m[j];for(i=0;i<b-1;i++)c=!0===this._isLeap(a)?c+n[i]:c+m[i];return c+=parseInt(d)},_get_nepali_date:function(a){for(var b= 0,d,c=5,e=j=9,f=16,g=2E3;0!=a;){var h=k[g];f++;c++;f>h[j]&&(j++,e++,f=1,d=7==c?0:c);6<c&&(c=0);if(12<e||12<j)g++,e=1,b++,j=1;a--}numDay=c;return[g,e,f,c,d]},_move:function(a,b,d){if("previous"===b)for("month"===a?(this.year=1<this.month?this.year:--this.year,this.month=1<this.month?--this.month:12):"year"===a&&(this.year=--this.year),yr=k[this.year],days=yr[this.month],""===f&&(f=nep_date[4]);0!=days;)0==f&&(f=7),f--,days--;else if("next"===b){yr=k[this.year];days=yr[this.month];for(""===f&&(f=nep_date[4]);0!= days;)f++,7==f&&(f=0),days--;"month"===a?(this.year=12>this.month?this.year:++this.year,this.month=12>this.month?++this.month:1):"year"===a&&(this.year=++this.year)}this._generateTemplate(d)},_engToNepDigit:function(a){a=""+a;for(var b="",d=0;a.length>d;d++)b+=this.options.nNum[a[d]];return b},getYear:function(){return this.year},getMonth:function(){return this.month},getMonthName:function(){return this.options.displayMonthAbbr?this.options.monthabbrs[this.month]:this.options.months[this.month]}, getCell:function(a){var b=Math.floor((a+this.startingDay-this.options.startIn)/7);a=a+this.startingDay-this.options.startIn-7*b-1;return this.$cal.find("div.fc-body").children("div.fc-row").eq(b).children("div").eq(a).children("div")},setData:function(a){a=a||{};e.extend(this.caldata,a);this._generateTemplate()},gotoNow:function(a){f="";this.month=today_nep[1];this.year=today_nep[0];this._generateTemplate(a)},"goto":function(a,b,d){this.month=a;this.year=b;this._generateTemplate(d)},gotoPreviousMonth:function(a){this._move("month", "previous",a)},gotoPreviousYear:function(a){this._move("year","previous",a)},gotoNextMonth:function(a){this._move("month","next",a)},gotoNextYear:function(a){this._move("year","next",a)}};e.fn.myCalendar=function(a){var b=e.data(this,"calendar");this.each(function(){b?b._init():b=e.data(this,"calendar",new e.Calendar(a,this))});return b}})(jQuery);